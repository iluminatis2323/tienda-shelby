<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>TucuShop</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <button class="toggle-tema" onclick="alternarTema()">ğŸŒ— Modo Claro/Oscuro</button>
  <h1>ğŸ›ï¸ğŸ›ï¸ TucuShop</h1>

  <!-- ğŸ—£ï¸ ReseÃ±as de usuarios -->
  <div class="reseÃ±as" id="reseÃ±as">
    <h2>ğŸ—£ï¸ Opiniones de nuestros usuarios</h2>
    <ul>
      <li>â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ â€œLa aplicaciÃ³n es excelente para ofrecer mis productos, muy intuitiva.â€ â€“ Carla (comerciante)</li>
      <li>â­ï¸â­ï¸â­ï¸â­ï¸ â€œFunciona muy bien, aunque se me trabÃ³ una vez, igual recomiendo.â€ â€“ Pablo (vendedor)</li>
      <li>â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ â€œGracias a TucuShop, empecÃ© a vender mis manualidades sin pagar comisiones.â€ â€“ Florencia</li>
      <li>â­ï¸â­ï¸â­ï¸ â€œEstÃ¡ buena pero estarÃ­a genial poder agregar mÃ¡s fotos por producto.â€ â€“ Juan</li>
      <li>â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ â€œMe encantÃ³, fÃ¡cil de usar y me conectÃ³ con muchos compradores.â€ â€“ Nati</li>
    </ul>
    <p style="text-align:center; margin-top: 10px;">
      <strong>ğŸ“¢ Esta app estÃ¡ pensada para comerciantes pequeÃ±os, feriantes, emprendedores y servicios locales.</strong>
    </p>
  </div>

  <!-- ğŸ” Filtros -->
  <div class="filtros">
    <input type="text" id="busqueda" placeholder="Buscar productos..." oninput="filtrarProductos()" />
    <select id="categoria" onchange="filtrarProductos()">
      <option value="">Todas las categorÃ­as</option>
      <option value="prestamos">ğŸ’¸ PrÃ©stamos personales</option>
      <option value="celulares">ğŸ“± Celulares y accesorios</option>
      <option value="notebooks">ğŸ’» Notebooks y tecnologÃ­a</option>
      <option value="electro">ğŸ›ï¸ ElectrodomÃ©sticos y muebles</option>
      <option value="hogar">ğŸª‘ Hogar</option>
      <option value="utiles">ğŸ’ Ãštiles escolares</option>
      <option value="herramientas">ğŸ’° Herramientas</option>
    </select>
  </div>

  <!-- BotÃ³n flotante para abrir/cerrar carrito -->
  <button id="btnCarrito" title="Abrir carrito">ğŸ›’</button>

  <!-- Panel flotante del carrito -->
  <div id="panelCarrito" aria-label="Carrito de compras" role="dialog" aria-modal="true" tabindex="-1">
    <button id="cerrarPanel" aria-label="Cerrar carrito">Ã—</button>
    <h3>ğŸ›’ Tu carrito</h3>
    <ul id="listaCarrito"></ul>
    <p><strong>Total:</strong> $<span id="totalCarrito">0</span></p>
    <button onclick="enviarCarritoWhatsApp()">ğŸ“² Solicitar carrito por WhatsApp</button>
    <button onclick="simularPago()" style="margin-top:10px;">ğŸ’³ Simular Pago QR</button>
  </div>

  <!-- ğŸ›ï¸ Productos -->
  <div class="productos grid" id="productos"></div>

  <!-- ğŸ”” NotificaciÃ³n flotante -->
  <div id="notificacion" style="display:none;"></div>

  <!-- ğŸ§  Scripts -->
  <script src="helpers.js"></script> <!-- si tenÃ©s funciones auxiliares -->
  <script src="tema.js"></script>    <!-- modo claro/oscuro -->

  <!-- ğŸŒ Scripts modulares -->
  <script type="module">
    import { agregarAlCarrito, cargarCarrito, cambiarCantidad, quitarDelCarrito, actualizarCarrito } from './tienda.cmds/carrito.js';
    import { mostrarProductos, filtrarProductos } from './tienda.cmds/productos.js';
    import { enviarCarritoWhatsApp } from './tienda.cmds/whatsapp.js';
    import { simularPago } from './tienda.cmds/simulador.js';

    window.agregarAlCarrito = agregarAlCarrito;
    window.enviarCarritoWhatsApp = enviarCarritoWhatsApp;
    window.simularPago = simularPago;
    window.filtrarProductos = () => filtrarProductos(productos, agregarAlCarrito);
    window.cambiarCantidad = cambiarCantidad;
    window.quitarDelCarrito = quitarDelCarrito;

    let productos = [];

    // Control para abrir/cerrar el carrito flotante
    const btnCarrito = document.getElementById('btnCarrito');
    const panelCarrito = document.getElementById('panelCarrito');
    const cerrarPanel = document.getElementById('cerrarPanel');

    btnCarrito.addEventListener('click', () => {
      if (panelCarrito.style.display === 'block') {
        panelCarrito.style.display = 'none';
        btnCarrito.title = "Abrir carrito";
      } else {
        panelCarrito.style.display = 'block';
        panelCarrito.focus();
        btnCarrito.title = "Cerrar carrito";
      }
    });

    cerrarPanel.addEventListener('click', () => {
      panelCarrito.style.display = 'none';
      btnCarrito.title = "Abrir carrito";
    });

    window.onload = async () => {
      try {
        const res = await fetch('https://tienda-shelby.onrender.com/productos');
        productos = await res.json();
        console.log("ğŸ“¦ Productos cargados:", productos);
        mostrarProductos(productos, agregarAlCarrito);
        cargarCarrito();
      } catch (err) {
        alert("âŒ No se pudieron cargar los productos.");
        console.error(err);
      }
    };
  </script>
</body>
</html>








