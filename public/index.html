<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>TucuShop</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <button class="toggle-tema" onclick="alternarTema()">🌗 Modo Claro/Oscuro</button>
  <h1>🛍️🛍️ TucuShop</h1>

  <!-- 🗣️ Reseñas de usuarios -->
  <div class="reseñas" id="reseñas">
    <h2>🗣️ Opiniones de nuestros usuarios</h2>
    <ul>
      <li>⭐️⭐️⭐️⭐️⭐️ “La aplicación es excelente para ofrecer mis productos, muy intuitiva.” – Carla (comerciante)</li>
      <li>⭐️⭐️⭐️⭐️ “Funciona muy bien, aunque se me trabó una vez, igual recomiendo.” – Pablo (vendedor)</li>
      <li>⭐️⭐️⭐️⭐️⭐️ “Gracias a TucuShop, empecé a vender mis manualidades sin pagar comisiones.” – Florencia</li>
      <li>⭐️⭐️⭐️ “Está buena pero estaría genial poder agregar más fotos por producto.” – Juan</li>
      <li>⭐️⭐️⭐️⭐️⭐️ “Me encantó, fácil de usar y me conectó con muchos compradores.” – Nati</li>
    </ul>
    <p style="text-align:center; margin-top: 10px;">
      <strong>📢 Esta app está pensada para comerciantes pequeños, feriantes, emprendedores y servicios locales.</strong>
    </p>
  </div>

  <!-- 🔍 Filtros -->
  <div class="filtros">
    <input type="text" id="busqueda" placeholder="Buscar productos..." oninput="filtrarProductos()" />
    <select id="categoria" onchange="filtrarProductos()">
      <option value="">Todas las categorías</option>
      <option value="prestamos">💸 Préstamos personales</option>
      <option value="celulares">📱 Celulares y accesorios</option>
      <option value="notebooks">💻 Notebooks y tecnología</option>
      <option value="electro">🛏️ Electrodomésticos y muebles</option>
      <option value="hogar">🪑 Hogar</option>
      <option value="utiles">🎒 Útiles escolares</option>
      <option value="herramientas">💰 Herramientas</option>
    </select>
  </div>

  <!-- Botón flotante para abrir/cerrar carrito -->
  <button id="btnCarrito" title="Abrir carrito">🛒</button>

  <!-- Panel flotante del carrito -->
  <div id="panelCarrito" aria-label="Carrito de compras" role="dialog" aria-modal="true" tabindex="-1">
    <button id="cerrarPanel" aria-label="Cerrar carrito">×</button>
    <h3>🛒 Tu carrito</h3>
    <ul id="listaCarrito"></ul>
    <p><strong>Total:</strong> $<span id="totalCarrito">0</span></p>
    <button onclick="enviarCarritoWhatsApp()">📲 Solicitar carrito por WhatsApp</button>
    <button onclick="simularPago()" style="margin-top:10px;">💳 Simular Pago QR</button>
  </div>

  <!-- 🛍️ Productos -->
  <div class="productos grid" id="productos"></div>

  <!-- 🔔 Notificación flotante -->
  <div id="notificacion" style="display:none;"></div>

  <!-- 🧠 Scripts -->
  <script src="helpers.js"></script> <!-- si tenés funciones auxiliares -->
  <script src="tema.js"></script>    <!-- modo claro/oscuro -->

  <!-- 🌐 Scripts modulares -->
  <script type="module">
    import { agregarAlCarrito, cargarCarrito, cambiarCantidad, quitarDelCarrito, actualizarCarrito } from './tienda.cmds/carrito.js';
    import { mostrarProductos, filtrarProductos } from './tienda.cmds/productos.js';
    import { enviarCarritoWhatsApp } from './tienda.cmds/whatsapp.js';
    import { simularPago } from './tienda.cmds/simulador.js';

    window.agregarAlCarrito = agregarAlCarrito;
    window.enviarCarritoWhatsApp = enviarCarritoWhatsApp;
    window.simularPago = simularPago;
    window.filtrarProductos = () => filtrarProductos(productos, agregarAlCarrito);
    window.cambiarCantidad = cambiarCantidad;
    window.quitarDelCarrito = quitarDelCarrito;

    let productos = [];

    // Control para abrir/cerrar el carrito flotante
    const btnCarrito = document.getElementById('btnCarrito');
    const panelCarrito = document.getElementById('panelCarrito');
    const cerrarPanel = document.getElementById('cerrarPanel');

    btnCarrito.addEventListener('click', () => {
      if (panelCarrito.style.display === 'block') {
        panelCarrito.style.display = 'none';
        btnCarrito.title = "Abrir carrito";
      } else {
        panelCarrito.style.display = 'block';
        panelCarrito.focus();
        btnCarrito.title = "Cerrar carrito";
      }
    });

    cerrarPanel.addEventListener('click', () => {
      panelCarrito.style.display = 'none';
      btnCarrito.title = "Abrir carrito";
    });

    window.onload = async () => {
      try {
        const res = await fetch('https://tienda-shelby.onrender.com/productos');
        productos = await res.json();
        console.log("📦 Productos cargados:", productos);
        mostrarProductos(productos, agregarAlCarrito);
        cargarCarrito();
      } catch (err) {
        alert("❌ No se pudieron cargar los productos.");
        console.error(err);
      }
    };
  </script>
</body>
</html>








